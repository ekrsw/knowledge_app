# タスクリスト - ナレッジ修正案承認システム フロントエンド実装

## 概要

- 総タスク数: 25
- 推定作業時間: 5-7日
- 優先度: 高
- 目的: Next.js 15.4.6を使用したフロントエンドUIの完成

## タスク一覧

### Phase 1: 基盤構築

#### Task 1.1: プロジェクト環境設定

- [x] Next.js 15.4.6の設定確認
- [x] TypeScript設定の確認と調整
- [x] ESLint/Prettierの設定
- [x] 環境変数設定（.env.local）
- **完了条件**: 開発サーバーが正常に起動し、TypeScriptエラーがない ✅
- **依存**: なし
- **推定時間**: 1時間

#### Task 1.2: API通信基盤の構築

- [x] axios/fetchラッパーの実装
- [x] APIベースURLの設定
- [x] エラーハンドリング共通処理
- [x] レスポンス型定義の基礎
- **完了条件**: APIクライアントが作成され、バックエンドと通信可能 ✅
- **依存**: Task 1.1
- **推定時間**: 2時間

#### Task 1.3: 型定義ファイルの作成

- [x] ユーザー関連の型定義（User, Role）
- [x] 修正案関連の型定義（Revision, Status）  
- [x] 記事関連の型定義（Article）
- [x] API レスポンスの型定義
- [x] バリデーションスキーマ（Zod）の実装
- [x] エラーハンドリング utilities の実装
- [x] API接続テスト機能の実装
- **完了条件**: 主要なエンティティの型定義、API接続テスト機能が完了 ✅
- **依存**: Task 1.2
- **推定時間**: 2時間

### Phase 2: 認証基盤

#### Task 2.1: 認証コンテキストの実装

- [x] AuthContextの作成
- [x] JWTトークン管理（localStorage/Cookie）
- [x] 認証状態管理
- [x] ユーザー情報管理
- **完了条件**: 認証状態が全体で共有可能 ✅
- **依存**: Task 1.3
- **推定時間**: 3時間

#### Task 2.2: ログインページの実装

- [x] ログインフォームUI
- [x] バリデーション実装
- [x] ログインAPI連携（/api/v1/auth/login/json）
- [x] エラーメッセージ表示
- **完了条件**: ユーザーがログインしてトークンを取得できる ✅
- **依存**: Task 2.1
- **推定時間**: 2時間

#### Task 2.3: 認証ガードの実装

- [ ] 保護されたルートコンポーネント
- [ ] 未認証時のリダイレクト
- [ ] ロール別アクセス制御
- [ ] ローディング状態の処理
- **完了条件**: 認証が必要なページが保護される
- **依存**: Task 2.2
- **推定時間**: 2時間

### Phase 3: 基本UIコンポーネント

#### Task 3.1: レイアウトコンポーネント

- [ ] ヘッダーコンポーネント
- [ ] サイドバー/ナビゲーション
- [ ] メインレイアウト
- [ ] フッター
- **完了条件**: 一貫したレイアウトで画面が表示される
- **依存**: Task 2.3
- **推定時間**: 2時間

#### Task 3.2: 共通UIコンポーネント

- [ ] ボタンコンポーネント
- [ ] フォーム入力コンポーネント
- [ ] モーダルコンポーネント
- [ ] アラート/トースト通知
- **完了条件**: 再利用可能なUIコンポーネントが揃う
- **依存**: Task 3.1
- **推定時間**: 3時間

#### Task 3.3: テーブルコンポーネント

- [ ] データテーブル基本実装
- [ ] ページネーション
- [ ] ソート機能
- [ ] フィルター機能
- **完了条件**: データ一覧表示が可能
- **依存**: Task 3.2
- **推定時間**: 3時間

### Phase 4: 修正案管理機能

#### Task 4.1: 修正案一覧ページ

- [ ] 修正案リストAPI連携（GET /api/v1/revisions/）
- [ ] 一覧表示UI
- [ ] ステータスバッジ表示
- [ ] ページネーション実装
- **完了条件**: 修正案一覧が表示され、ページ送りが動作する
- **依存**: Task 3.3
- **推定時間**: 3時間

#### Task 4.2: 修正案詳細ページ

- [ ] 詳細取得API連携（GET /api/v1/revisions/{id}）
- [ ] 詳細情報表示UI
- [ ] ステータス表示
- [ ] アクションボタン配置
- **完了条件**: 修正案の詳細情報が確認できる
- **依存**: Task 4.1
- **推定時間**: 3時間

#### Task 4.3: 修正案作成フォーム（基本）

- [ ] 記事選択UI
- [ ] 承認者選択UI
- [ ] 基本フィールド入力（タイトル、理由）
- [ ] 作成API連携（POST /api/v1/revisions/）
- **完了条件**: 最小限の修正案が作成できる
- **依存**: Task 4.2
- **推定時間**: 4時間

#### Task 4.4: 修正案作成フォーム（全フィールド）

- [ ] 全after_*フィールドの入力UI
- [ ] 日付ピッカー実装
- [ ] カテゴリ選択実装
- [ ] バリデーション強化
- **完了条件**: 全フィールドを含む修正案が作成できる
- **依存**: Task 4.3
- **推定時間**: 3時間

#### Task 4.5: 修正案ステータス操作

- [ ] 提出機能（POST /proposals/{id}/submit）
- [ ] 撤回機能（POST /proposals/{id}/withdraw）
- [ ] 削除機能（DELETE /proposals/{id}）
- [ ] 確認ダイアログ実装
- **完了条件**: ステータス遷移が正しく動作する
- **依存**: Task 4.4
- **推定時間**: 3時間

### Phase 5: 承認ワークフロー

#### Task 5.1: 承認キューページ

- [ ] 承認待ち一覧API連携（GET /api/v1/approvals/queue）
- [ ] 承認待ちリスト表示
- [ ] 優先度表示
- [ ] クイックアクション
- **完了条件**: 承認者が承認待ち案件を確認できる
- **依存**: Task 4.5
- **推定時間**: 3時間

#### Task 5.2: 承認・却下機能

- [ ] 承認/却下フォーム
- [ ] コメント入力
- [ ] 承認API連携（POST /approvals/{id}/decide）
- [ ] 処理結果表示
- **完了条件**: 承認・却下が実行できる
- **依存**: Task 5.1
- **推定時間**: 3時間

### Phase 6: 差分表示機能

#### Task 6.1: 基本差分表示

- [ ] 差分取得API連携（GET /api/v1/diffs/{id}）
- [ ] フィールド別差分表示
- [ ] 変更前後の値表示
- [ ] 変更なしフィールドの表示
- **完了条件**: 修正案の差分が視覚的に確認できる
- **依存**: Task 5.2
- **推定時間**: 4時間

#### Task 6.2: 高度な差分表示

- [ ] テキスト差分のハイライト
- [ ] 統合差分ビューアー
- [ ] 変更サマリー表示
- [ ] 差分エクスポート機能
- **完了条件**: 詳細な差分比較が可能
- **依存**: Task 6.1
- **推定時間**: 4時間

### Phase 7: ダッシュボード

#### Task 7.1: ホームダッシュボード

- [ ] 自分の修正案サマリー
- [ ] 承認待ち件数表示（承認者向け）
- [ ] 最近の活動表示
- [ ] クイックアクセスリンク
- **完了条件**: ユーザーが概要を一目で把握できる
- **依存**: Task 6.2
- **推定時間**: 3時間

#### Task 7.2: 通知機能

- [ ] 通知一覧API連携（GET /api/v1/notifications/my-notifications）
- [ ] 未読通知カウント表示
- [ ] 通知リスト表示
- [ ] 既読化機能
- **完了条件**: 通知が確認・管理できる
- **依存**: Task 7.1
- **推定時間**: 3時間

### Phase 8: 品質向上

#### Task 8.1: エラーハンドリング強化

- [ ] グローバルエラーバウンダリ
- [ ] API エラーの統一処理
- [ ] ユーザーフレンドリーなエラーメッセージ
- [ ] リトライ機能
- **完了条件**: エラー時も適切に動作する
- **依存**: Task 7.2
- **推定時間**: 2時間

#### Task 8.2: パフォーマンス最適化

- [ ] データのキャッシング
- [ ] 遅延読み込み実装
- [ ] 画像最適化
- [ ] バンドルサイズ最適化
- **完了条件**: ページ読み込みが高速化される
- **依存**: Task 8.1
- **推定時間**: 3時間

#### Task 8.3: レスポンシブ対応

- [ ] モバイルレイアウト調整
- [ ] タブレット対応
- [ ] タッチ操作対応
- [ ] 画面サイズ別の最適化
- **完了条件**: 全デバイスで適切に表示される
- **依存**: Task 8.2
- **推定時間**: 3時間

## 実装順序

1. Phase 1-3を順次実行（基盤構築）
2. Phase 4を実行（コア機能）
3. Phase 5-6を並行実行可能
4. Phase 7を実行（統合機能）
5. Phase 8を実行（品質向上）

## リスクと対策

- **API仕様変更**: API設計書を常に参照し、型定義を最新化
- **認証エラー**: トークンリフレッシュの実装検討
- **パフォーマンス**: 早期から最適化を意識した実装
- **ブラウザ互換性**: 主要ブラウザでの動作確認

## 注意事項

- 各タスクはコミット単位で完結させる
- APIとの連携は型安全性を保つ
- UIの一貫性を保つためデザインシステムを活用
- テスト可能な構造で実装する
- バックエンドは修正せず、既存のAPIを活用する

## 実装開始ガイド

1. このタスクリストに従って順次実装を進めてください
2. 各タスクの開始時にTodoWriteでin_progressに更新
3. 完了時はcompletedに更新
4. 問題発生時は速やかに報告してください
5. 各フェーズ完了時に動作確認を実施してください

## API エンドポイント参照

主要なAPIエンドポイント（実装時に参照）:
- 認証: `/api/v1/auth/login/json`
- 修正案: `/api/v1/revisions/`, `/api/v1/proposals/`
- 承認: `/api/v1/approvals/`
- 差分: `/api/v1/diffs/`
- 通知: `/api/v1/notifications/`
- ユーザー: `/api/v1/users/`
- 記事: `/api/v1/articles/`